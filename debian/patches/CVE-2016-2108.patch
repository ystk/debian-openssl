Index: openssl-1.0.1k/crypto/asn1/a_int.c
===================================================================
--- openssl-1.0.1k.orig/crypto/asn1/a_int.c
+++ openssl-1.0.1k/crypto/asn1/a_int.c
@@ -124,6 +124,8 @@ int i2c_ASN1_INTEGER(ASN1_INTEGER *a, un
 		{
 		ret=a->length;
 		i=a->data[0];
+                if (ret == 1 && i == 0)
+                    neg = 0;
 		if (!neg && (i > 127)) {
 			pad=1;
 			pb=0;
@@ -157,7 +159,7 @@ int i2c_ASN1_INTEGER(ASN1_INTEGER *a, un
 		p += a->length - 1;
 		i = a->length;
 		/* Copy zeros to destination as long as source is zero */
-		while(!*n) {
+                while (!*n && i > 1) {
 			*(p--) = 0;
 			n--;
 			i--;
@@ -415,7 +417,7 @@ ASN1_INTEGER *BN_to_ASN1_INTEGER(const B
 		ASN1err(ASN1_F_BN_TO_ASN1_INTEGER,ERR_R_NESTED_ASN1_ERROR);
 		goto err;
 		}
-	if (BN_is_negative(bn))
+    if (BN_is_negative(bn) && !BN_is_zero(bn))
 		ret->type = V_ASN1_NEG_INTEGER;
 	else ret->type=V_ASN1_INTEGER;
 	j=BN_num_bits(bn);
Index: openssl-1.0.1k/crypto/asn1/a_type.c
===================================================================
--- openssl-1.0.1k.orig/crypto/asn1/a_type.c
+++ openssl-1.0.1k/crypto/asn1/a_type.c
@@ -131,9 +131,7 @@ int ASN1_TYPE_cmp(const ASN1_TYPE *a, co
 		result = 0;	/* They do not have content. */
 		break;
 	case V_ASN1_INTEGER:
-	case V_ASN1_NEG_INTEGER:
 	case V_ASN1_ENUMERATED:
-	case V_ASN1_NEG_ENUMERATED:
 	case V_ASN1_BIT_STRING:
 	case V_ASN1_OCTET_STRING:
 	case V_ASN1_SEQUENCE:
Index: openssl-1.0.1k/crypto/asn1/tasn_dec.c
===================================================================
--- openssl-1.0.1k.orig/crypto/asn1/tasn_dec.c
+++ openssl-1.0.1k/crypto/asn1/tasn_dec.c
@@ -1014,9 +1014,7 @@ int asn1_ex_c2i(ASN1_VALUE **pval, const
 		break;
 
 		case V_ASN1_INTEGER:
-		case V_ASN1_NEG_INTEGER:
 		case V_ASN1_ENUMERATED:
-		case V_ASN1_NEG_ENUMERATED:
 		tint = (ASN1_INTEGER **)pval;
 		if (!c2i_ASN1_INTEGER(tint, &cont, len))
 			goto err;
Index: openssl-1.0.1k/crypto/asn1/tasn_enc.c
===================================================================
--- openssl-1.0.1k.orig/crypto/asn1/tasn_enc.c
+++ openssl-1.0.1k/crypto/asn1/tasn_enc.c
@@ -643,9 +643,7 @@ int asn1_ex_i2c(ASN1_VALUE **pval, unsig
 		break;
 
 		case V_ASN1_INTEGER:
-		case V_ASN1_NEG_INTEGER:
 		case V_ASN1_ENUMERATED:
-		case V_ASN1_NEG_ENUMERATED:
 		/* These are all have the same content format
 		 * as ASN1_INTEGER
 		 */
