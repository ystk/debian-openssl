From: Matt Caswell <matt@openssl.org>
Date: Thu, 19 Aug 2021 12:23:38 +0100
Subject: Fix NETSCAPE_SPKI_print function to not assume NUL terminated
 strings

ASN.1 strings may not be NUL terminated. Don't assume they are.
---
 crypto/asn1/t_spki.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: openssl1.0-1.0.2u/crypto/asn1/t_spki.c
===================================================================
--- openssl1.0-1.0.2u.orig/crypto/asn1/t_spki.c	2021-09-29 16:12:24.478714482 +0200
+++ openssl1.0-1.0.2u/crypto/asn1/t_spki.c	2021-09-29 16:14:07.522655151 +0200
@@ -90,7 +90,7 @@
     }
     chal = spki->spkac->challenge;
     if (chal->length)
-        BIO_printf(out, "  Challenge String: %s\n", chal->data);
+        BIO_printf(out, "  Challenge String: %.*s\n", chal->length, chal->data);
     i = OBJ_obj2nid(spki->sig_algor->algorithm);
     BIO_printf(out, "  Signature Algorithm: %s",
                (i == NID_undef) ? "UNKNOWN" : OBJ_nid2ln(i));
